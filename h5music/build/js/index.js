var controlManager,songlist,$=window.Zepto,root=window.player,$scope=$(document.body),audioManager=new root.audioManager;function getData(o){$.ajax({type:"GET",url:o,success:function(o){void 0,songlist=o,root.render(o[0]),root.processor.renderEndTime(o[0].duration),root.songList.renderList(songlist),controlManager=new root.controlManager(songlist.length),audioManager.setSrc(o[0].audio),bindClick(),bindTouch()},error:function(o){void 0}})}function bindClick(){$scope.on("play:change",function(o,n){songlist[n].isLike?$scope.find(".btn-like").addClass("liking"):$scope.find(".btn-like").removeClass("liking"),root.render(songlist[n]),root.processor.renderEndTime(songlist[n].duration),audioManager.setSrc(songlist[n].audio),audioManager.play(),root.processor.start()}),$scope.on("click",".btn-play",function(){"play"==audioManager.audio.status?(audioManager.pause(),root.processor.stop()):(audioManager.play(),root.processor.start())}),$scope.on("click",".btn-pre",function(){controlManager.prev(),$scope.trigger("play:change",controlManager.index)}),$scope.on("click",".btn-next",function(){controlManager.next(),$scope.trigger("play:change",controlManager.index)}),$scope.on("click",".btn-songlist",function(){$scope.find(".songlist").toggleClass("show")})}function bindTouch(){var o=$(".slider-pointer"),n=$(".pro-bottom").offset(),e=n.left,r=n.width;o.on("touchstart",function(){root.processor.stop()}).on("touchmove",function(o){var n=(o.changedTouches[0].clientX-e)/r;(1<n||n<0)&&(n=0),root.processor.updata(n)}).on("touchend",function(o){var n=(o.changedTouches[0].clientX-e)/r;(1<n||n<0)&&(n=0);var t=n*songlist[controlManager.index].duration;audioManager.jumpTo(t),root.processor.start(n),$scope.find(".btn-play").addClass("play")})}getData("../../source/data.json");